---
---
<div class="delivery-container">
  <table class="delivery-table">
    <caption>Tabla de precios por distrito</caption>
    <thead>
      <tr>
        <th scope="col">Distrito</th>
        <th scope="col">Precio de Env√≠o</th>
        <th scope="col">Tiempo Estimado</th>
        <th scope="col">Pedido M√≠nimo</th>
        <th scope="col" class="free-shipping-header">üéÅ Env√≠o Gratis</th>
      </tr>
    </thead>
    <tbody id="delivery-tbody">
      <tr>
        <td colspan="5" style="text-align: center;">Cargando zonas de delivery...</td>
      </tr>
    </tbody>
  </table>
</div>

<script is:inline>
  (() => {
    const tbody = document.getElementById('delivery-tbody');
    if (!tbody) return;

    fetch('/data/deliveries.json')
      .then(response => response.json())
      .then(deliveries => {
        if (deliveries.length === 0) {
          tbody.innerHTML = '<tr><td colspan="5" style="text-align: center;">No hay zonas de delivery disponibles</td></tr>';
          return;
        }

        tbody.innerHTML = deliveries.map(delivery => {
          const freeShipping = delivery.freeShipping || 0;
          let freeShippingCell = '';
          
          if (freeShipping > 0) {
            freeShippingCell = `<td class="free-shipping"><span class="badge-free">¬°S√ç!</span> Compras sobre S/. ${freeShipping.toFixed(2)}</td>`;
          } else {
            freeShippingCell = '<td class="no-free-shipping">No disponible</td>';
          }
          
          return `
            <tr>
              <td><strong>${delivery.district}</strong></td>
              <td class="price">S/. ${delivery.price.toFixed(2)}</td>
              <td>${delivery.time}</td>
              <td>S/. ${delivery.minOrder.toFixed(2)}</td>
              ${freeShippingCell}
            </tr>
          `;
        }).join('');
      })
      .catch(error => {
        console.error('Error cargando deliveries:', error);
        tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: red;">Error al cargar zonas de delivery</td></tr>';
      });
  })();
</script>

<style>
  .delivery-container {
    overflow-x: auto;
  }

  .delivery-table {
    width: 100%;
    border-collapse: collapse;
    background: var(--white);
    box-shadow: var(--shadow);
    border-radius: var(--radius);
    overflow: hidden;
    min-width: 600px;
  }

  .delivery-table caption {
    font-size: 1.3rem;
    font-weight: 700;
    color: var(--primary-dark);
    padding: 1rem;
    text-align: left;
  }

  .delivery-table th {
    padding: 1rem;
    text-align: center;
    border-bottom: 1px solid #eee;
    background-color: var(--primary-color);
    color: var(--white);
    font-size: 1rem;
    font-weight: 700;
  }

  :global(.delivery-table td) {
    padding: 1rem;
    text-align: center;
    border-bottom: 1px solid #eee;
  }

  :global(#delivery-tbody tr:hover) {
    background-color: var(--secondary-color);
  }

  :global(#delivery-tbody .price) {
    color: var(--primary-dark);
    font-weight: 700;
    font-size: 1.1rem;
  }

  .free-shipping-header {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%) !important;
    font-size: 1.1rem !important;
  }

  :global(.free-shipping) {
    background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
    font-weight: 600;
    color: #2e7d32;
  }

  :global(.badge-free) {
    display: inline-block;
    background: #27ae60;
    color: white;
    padding: 0.2rem 0.6rem;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 700;
    margin-right: 0.3rem;
    animation: pulse-badge 2s infinite;
  }

  @keyframes pulse-badge {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }

  :global(.no-free-shipping) {
    color: #999;
    font-style: italic;
    font-size: 0.9rem;
  }

  @media (max-width: 768px) {
    .delivery-table {
      font-size: 0.85rem;
      min-width: 700px;
    }

    .delivery-table th,
    .delivery-table td {
      padding: 0.75rem 0.4rem;
    }

    :global(.badge-free) {
      font-size: 0.75rem;
      padding: 0.15rem 0.4rem;
    }
  }
</style>
